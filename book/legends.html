<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Legends | ComplexHeatmap Complete Reference</title>
  <meta name="description" content="Complex heatmaps are efficient to visualize associations between different sources of data sets and reveal potential patterns. Here the ComplexHeatmap R package provides a highly flexible way to arrange multiple heatmaps and supports various annotation graphics. This book is the complete reference to ComplexHeatmap pacakge." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Legends | ComplexHeatmap Complete Reference" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://jokergoo.github.io/ComplexHeatmap-reference/book" />
  <meta property="og:image" content="https://jokergoo.github.io/ComplexHeatmap-reference/bookcomplexheatmap-cover.jpg" />
  <meta property="og:description" content="Complex heatmaps are efficient to visualize associations between different sources of data sets and reveal potential patterns. Here the ComplexHeatmap R package provides a highly flexible way to arrange multiple heatmaps and supports various annotation graphics. This book is the complete reference to ComplexHeatmap pacakge." />
  <meta name="github-repo" content="jokergoo/ComplexHeatmap-reference" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Legends | ComplexHeatmap Complete Reference" />
  
  <meta name="twitter:description" content="Complex heatmaps are efficient to visualize associations between different sources of data sets and reveal potential patterns. Here the ComplexHeatmap R package provides a highly flexible way to arrange multiple heatmaps and supports various annotation graphics. This book is the complete reference to ComplexHeatmap pacakge." />
  <meta name="twitter:image" content="https://jokergoo.github.io/ComplexHeatmap-reference/bookcomplexheatmap-cover.jpg" />

<meta name="author" content="Zuguang Gu" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="a-list-of-heatmaps.html"/>
<link rel="next" href="heatmap-decoration.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ComplexHeatmap Complete Reference</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#general-design"><i class="fa fa-check"></i><b>1.1</b> General design</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#a-brief-description-of-following-chapters"><i class="fa fa-check"></i><b>1.2</b> A brief description of following chapters</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html"><i class="fa fa-check"></i><b>2</b> A Single Heatmap</a><ul>
<li class="chapter" data-level="2.1" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#colors"><i class="fa fa-check"></i><b>2.1</b> Colors</a></li>
<li class="chapter" data-level="2.2" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#heatmap-titles"><i class="fa fa-check"></i><b>2.2</b> Titles</a></li>
<li class="chapter" data-level="2.3" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#clustering"><i class="fa fa-check"></i><b>2.3</b> Clustering</a><ul>
<li class="chapter" data-level="2.3.1" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#distance-methods"><i class="fa fa-check"></i><b>2.3.1</b> Distance methods</a></li>
<li class="chapter" data-level="2.3.2" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#clustering-methods"><i class="fa fa-check"></i><b>2.3.2</b> Clustering methods</a></li>
<li class="chapter" data-level="2.3.3" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#render-dendrograms"><i class="fa fa-check"></i><b>2.3.3</b> Render dendrograms</a></li>
<li class="chapter" data-level="2.3.4" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#reorder-dendrograms"><i class="fa fa-check"></i><b>2.3.4</b> Reorder dendrograms</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#row-and_column_orders"><i class="fa fa-check"></i><b>2.4</b> Set row and column orders</a></li>
<li class="chapter" data-level="2.5" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#heatmap-seriation"><i class="fa fa-check"></i><b>2.5</b> Seriation</a></li>
<li class="chapter" data-level="2.6" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#dimension-names"><i class="fa fa-check"></i><b>2.6</b> Dimension names</a></li>
<li class="chapter" data-level="2.7" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#heatmap-split"><i class="fa fa-check"></i><b>2.7</b> Heatmap split</a><ul>
<li class="chapter" data-level="2.7.1" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#split-by-kmeans-clustering"><i class="fa fa-check"></i><b>2.7.1</b> Split by k-means clustering</a></li>
<li class="chapter" data-level="2.7.2" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#split-by-categorical-variables"><i class="fa fa-check"></i><b>2.7.2</b> Split by categorical variables</a></li>
<li class="chapter" data-level="2.7.3" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#spilt-by-dendrogram"><i class="fa fa-check"></i><b>2.7.3</b> Split by dendrogram</a></li>
<li class="chapter" data-level="2.7.4" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#order-of-slices"><i class="fa fa-check"></i><b>2.7.4</b> Order of slices</a></li>
<li class="chapter" data-level="2.7.5" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#titles-for-splitting"><i class="fa fa-check"></i><b>2.7.5</b> Titles for splitting</a></li>
<li class="chapter" data-level="2.7.6" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#graphic-parameters-for-splitting"><i class="fa fa-check"></i><b>2.7.6</b> Graphic parameters for splitting</a></li>
<li class="chapter" data-level="2.7.7" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#gaps-between-slices"><i class="fa fa-check"></i><b>2.7.7</b> Gaps between slices</a></li>
<li class="chapter" data-level="2.7.8" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#split-heatmap-annotations"><i class="fa fa-check"></i><b>2.7.8</b> Split heatmap annotations</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#heatmap-as-raster-image"><i class="fa fa-check"></i><b>2.8</b> Heatmap as raster image</a></li>
<li class="chapter" data-level="2.9" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#customize-the-heatmap-body"><i class="fa fa-check"></i><b>2.9</b> Customize the heatmap body</a><ul>
<li class="chapter" data-level="2.9.1" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#cell-fun"><i class="fa fa-check"></i><b>2.9.1</b> cell_fun</a></li>
<li class="chapter" data-level="2.9.2" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#layer-fun"><i class="fa fa-check"></i><b>2.9.2</b> layer_fun</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#size-of-the-heatmap"><i class="fa fa-check"></i><b>2.10</b> Size of the heatmap</a></li>
<li class="chapter" data-level="2.11" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#plot-the-heatmap"><i class="fa fa-check"></i><b>2.11</b> Plot the heatmap</a></li>
<li class="chapter" data-level="2.12" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#get-orders-and-dendrograms-from-heatmap"><i class="fa fa-check"></i><b>2.12</b> Get orders and dendrograms</a></li>
<li class="chapter" data-level="2.13" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#subset-a-heatmap"><i class="fa fa-check"></i><b>2.13</b> Subset a heatmap</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html"><i class="fa fa-check"></i><b>3</b> Heatmap Annotations</a><ul>
<li class="chapter" data-level="3.1" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#simple-annotation"><i class="fa fa-check"></i><b>3.1</b> Simple annotation</a></li>
<li class="chapter" data-level="3.2" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#simple-annotation-as-an-annotation-function"><i class="fa fa-check"></i><b>3.2</b> Simple annotation as an annotation function</a></li>
<li class="chapter" data-level="3.3" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#empty-annotation"><i class="fa fa-check"></i><b>3.3</b> Empty annotation</a></li>
<li class="chapter" data-level="3.4" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#block-annotation"><i class="fa fa-check"></i><b>3.4</b> Block annotation</a></li>
<li class="chapter" data-level="3.5" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#image-annotation"><i class="fa fa-check"></i><b>3.5</b> Image annotation</a></li>
<li class="chapter" data-level="3.6" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#points-annotation"><i class="fa fa-check"></i><b>3.6</b> Points annotation</a></li>
<li class="chapter" data-level="3.7" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#lines-annotation"><i class="fa fa-check"></i><b>3.7</b> Lines annotation</a></li>
<li class="chapter" data-level="3.8" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#barplot_annotation"><i class="fa fa-check"></i><b>3.8</b> Barplot annotation</a></li>
<li class="chapter" data-level="3.9" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#box-annotation"><i class="fa fa-check"></i><b>3.9</b> Boxplot annotation</a></li>
<li class="chapter" data-level="3.10" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#histogram-annotation"><i class="fa fa-check"></i><b>3.10</b> Histogram annotation</a></li>
<li class="chapter" data-level="3.11" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#density-annotation"><i class="fa fa-check"></i><b>3.11</b> Density annotation</a></li>
<li class="chapter" data-level="3.12" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#joyplot-annotation"><i class="fa fa-check"></i><b>3.12</b> Joyplot annotation</a></li>
<li class="chapter" data-level="3.13" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#horizon-chart-annotation"><i class="fa fa-check"></i><b>3.13</b> Horizon chart annotation</a></li>
<li class="chapter" data-level="3.14" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#text-annotation"><i class="fa fa-check"></i><b>3.14</b> Text annotation</a></li>
<li class="chapter" data-level="3.15" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#mark-annotation"><i class="fa fa-check"></i><b>3.15</b> Mark annotation</a></li>
<li class="chapter" data-level="3.16" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#summary-annotation"><i class="fa fa-check"></i><b>3.16</b> Summary annotation</a></li>
<li class="chapter" data-level="3.17" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#zoom-annotation"><i class="fa fa-check"></i><b>3.17</b> Zoom annotation</a></li>
<li class="chapter" data-level="3.18" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#multiple-annotations"><i class="fa fa-check"></i><b>3.18</b> Multiple annotations</a><ul>
<li class="chapter" data-level="3.18.1" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#size-of-annotations"><i class="fa fa-check"></i><b>3.18.1</b> Size of annotations</a></li>
<li class="chapter" data-level="3.18.2" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#annotation-labels"><i class="fa fa-check"></i><b>3.18.2</b> Annotation labels</a></li>
</ul></li>
<li class="chapter" data-level="3.19" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#heatmap-annotation-utility-function"><i class="fa fa-check"></i><b>3.19</b> Utility functions</a></li>
<li class="chapter" data-level="3.20" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#implement-new-annotation-functions"><i class="fa fa-check"></i><b>3.20</b> Implement new annotation functions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html"><i class="fa fa-check"></i><b>4</b> A List of Heatmaps</a><ul>
<li class="chapter" data-level="4.1" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#heatmap-list-titles"><i class="fa fa-check"></i><b>4.1</b> Titles</a></li>
<li class="chapter" data-level="4.2" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#size-of-heatmaps"><i class="fa fa-check"></i><b>4.2</b> Size of heatmaps</a></li>
<li class="chapter" data-level="4.3" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#gap-between-heatmaps"><i class="fa fa-check"></i><b>4.3</b> Gap between heatmaps</a></li>
<li class="chapter" data-level="4.4" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#automatic-adjustment-to-the-main-heatmap"><i class="fa fa-check"></i><b>4.4</b> Automatic adjustment to the main heatmap</a></li>
<li class="chapter" data-level="4.5" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#control-main-heatmap-in-draw-function"><i class="fa fa-check"></i><b>4.5</b> Control main heatmap in draw() function</a></li>
<li class="chapter" data-level="4.6" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#annotations-as-components-are-adjusted"><i class="fa fa-check"></i><b>4.6</b> Annotations as components are adjusted</a></li>
<li class="chapter" data-level="4.7" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#concatenate-with-annotations"><i class="fa fa-check"></i><b>4.7</b> Concatenate with annotations</a></li>
<li class="chapter" data-level="4.8" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#concatenate-only-the-annotations"><i class="fa fa-check"></i><b>4.8</b> Concatenate only the annotations</a></li>
<li class="chapter" data-level="4.9" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#vertical-concatenation"><i class="fa fa-check"></i><b>4.9</b> Vertical concatenation</a></li>
<li class="chapter" data-level="4.10" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#subset-heatmap-list"><i class="fa fa-check"></i><b>4.10</b> Subset the heatmap list</a></li>
<li class="chapter" data-level="4.11" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#plot-the-heamtap-list"><i class="fa fa-check"></i><b>4.11</b> Plot the heatmap list</a></li>
<li class="chapter" data-level="4.12" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#get-orders-and-dendrograms-from-a-list-of-heatmaps"><i class="fa fa-check"></i><b>4.12</b> Get orders and dendrograms</a></li>
<li class="chapter" data-level="4.13" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#change-parameters-globally"><i class="fa fa-check"></i><b>4.13</b> Change parameters globally</a></li>
<li class="chapter" data-level="4.14" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#adjust-blank-space-caused-by-annotations"><i class="fa fa-check"></i><b>4.14</b> Adjust blank space caused by annotations</a></li>
<li class="chapter" data-level="4.15" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#manually-increase-space-around-the-plot"><i class="fa fa-check"></i><b>4.15</b> Manually increase space around the plot</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="legends.html"><a href="legends.html"><i class="fa fa-check"></i><b>5</b> Legends</a><ul>
<li class="chapter" data-level="5.1" data-path="legends.html"><a href="legends.html#continuous-legends"><i class="fa fa-check"></i><b>5.1</b> Continuous legends</a></li>
<li class="chapter" data-level="5.2" data-path="legends.html"><a href="legends.html#discrete-legends"><i class="fa fa-check"></i><b>5.2</b> Discrete legends</a></li>
<li class="chapter" data-level="5.3" data-path="legends.html"><a href="legends.html#a-list-of-legends"><i class="fa fa-check"></i><b>5.3</b> A list of legends</a></li>
<li class="chapter" data-level="5.4" data-path="legends.html"><a href="legends.html#heatmap-and-annotation-legends"><i class="fa fa-check"></i><b>5.4</b> Heatmap and annotation legends</a></li>
<li class="chapter" data-level="5.5" data-path="legends.html"><a href="legends.html#add-customized-legends"><i class="fa fa-check"></i><b>5.5</b> Add customized legends</a></li>
<li class="chapter" data-level="5.6" data-path="legends.html"><a href="legends.html#the-side-of-legends"><i class="fa fa-check"></i><b>5.6</b> The side of legends</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html"><i class="fa fa-check"></i><b>6</b> Heatmap Decoration</a><ul>
<li class="chapter" data-level="6.1" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html#decoration-functions"><i class="fa fa-check"></i><b>6.1</b> Decoration functions</a></li>
<li class="chapter" data-level="6.2" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html#decoration-examples"><i class="fa fa-check"></i><b>6.2</b> Examples</a><ul>
<li class="chapter" data-level="6.2.1" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html#barplot-for-single-column-heatmap"><i class="fa fa-check"></i><b>6.2.1</b> Barplot for single-column heatmap</a></li>
<li class="chapter" data-level="6.2.2" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html#add-titles-for-row-annotations"><i class="fa fa-check"></i><b>6.2.2</b> Add titles for row annotations</a></li>
<li class="chapter" data-level="6.2.3" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html#other-possible-use-of-decorations"><i class="fa fa-check"></i><b>6.2.3</b> Other possible use of decorations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="oncoprint.html"><a href="oncoprint.html"><i class="fa fa-check"></i><b>7</b> OncoPrint</a><ul>
<li class="chapter" data-level="7.1" data-path="oncoprint.html"><a href="oncoprint.html#oncoprint-general-settings"><i class="fa fa-check"></i><b>7.1</b> General settings</a><ul>
<li class="chapter" data-level="7.1.1" data-path="oncoprint.html"><a href="oncoprint.html#input-data-format"><i class="fa fa-check"></i><b>7.1.1</b> Input data format</a></li>
<li class="chapter" data-level="7.1.2" data-path="oncoprint.html"><a href="oncoprint.html#define-the-alter-fun"><i class="fa fa-check"></i><b>7.1.2</b> Define the alter_fun()</a></li>
<li class="chapter" data-level="7.1.3" data-path="oncoprint.html"><a href="oncoprint.html#oncoprint-background"><i class="fa fa-check"></i><b>7.1.3</b> Background</a></li>
<li class="chapter" data-level="7.1.4" data-path="oncoprint.html"><a href="oncoprint.html#complex-alteration-types"><i class="fa fa-check"></i><b>7.1.4</b> Complex alteration types</a></li>
<li class="chapter" data-level="7.1.5" data-path="oncoprint.html"><a href="oncoprint.html#simplify-alter_fun"><i class="fa fa-check"></i><b>7.1.5</b> Simplify alter_fun</a></li>
<li class="chapter" data-level="7.1.6" data-path="oncoprint.html"><a href="oncoprint.html#other-heatmap-related-settings"><i class="fa fa-check"></i><b>7.1.6</b> Other heatmap-related settings</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="oncoprint.html"><a href="oncoprint.html#apply-to-cbioportal-dataset"><i class="fa fa-check"></i><b>7.2</b> Apply to cBioPortal dataset</a><ul>
<li class="chapter" data-level="7.2.1" data-path="oncoprint.html"><a href="oncoprint.html#remove-empty-rows-and-columns"><i class="fa fa-check"></i><b>7.2.1</b> Remove empty rows and columns</a></li>
<li class="chapter" data-level="7.2.2" data-path="oncoprint.html"><a href="oncoprint.html#reorder-the-oncoprint"><i class="fa fa-check"></i><b>7.2.2</b> Reorder the oncoPrint</a></li>
<li class="chapter" data-level="7.2.3" data-path="oncoprint.html"><a href="oncoprint.html#oncoprint-annotations"><i class="fa fa-check"></i><b>7.2.3</b> OncoPrint annotations</a></li>
<li class="chapter" data-level="7.2.4" data-path="oncoprint.html"><a href="oncoprint.html#oncoprint-as-a-heatmap"><i class="fa fa-check"></i><b>7.2.4</b> oncoPrint as a Heatmap</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="upset-plot.html"><a href="upset-plot.html"><i class="fa fa-check"></i><b>8</b> UpSet plot</a><ul>
<li class="chapter" data-level="8.1" data-path="upset-plot.html"><a href="upset-plot.html#input-data"><i class="fa fa-check"></i><b>8.1</b> Input data</a></li>
<li class="chapter" data-level="8.2" data-path="upset-plot.html"><a href="upset-plot.html#upset-mode"><i class="fa fa-check"></i><b>8.2</b> Mode</a></li>
<li class="chapter" data-level="8.3" data-path="upset-plot.html"><a href="upset-plot.html#make-the-combination-matrix"><i class="fa fa-check"></i><b>8.3</b> Make the combination matrix</a></li>
<li class="chapter" data-level="8.4" data-path="upset-plot.html"><a href="upset-plot.html#upset-utility-functions"><i class="fa fa-check"></i><b>8.4</b> Utility functions</a></li>
<li class="chapter" data-level="8.5" data-path="upset-plot.html"><a href="upset-plot.html#upset-making-the-plot"><i class="fa fa-check"></i><b>8.5</b> Make the plot</a></li>
<li class="chapter" data-level="8.6" data-path="upset-plot.html"><a href="upset-plot.html#upset-plots-as-heatmaps"><i class="fa fa-check"></i><b>8.6</b> UpSet plots as heatmaps</a></li>
<li class="chapter" data-level="8.7" data-path="upset-plot.html"><a href="upset-plot.html#example-with-the-movies-dataset"><i class="fa fa-check"></i><b>8.7</b> Example with the movies dataset</a></li>
<li class="chapter" data-level="8.8" data-path="upset-plot.html"><a href="upset-plot.html#example-with-the-genomic-regions"><i class="fa fa-check"></i><b>8.8</b> Example with the genomic regions</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="more-examples.html"><a href="more-examples.html"><i class="fa fa-check"></i><b>9</b> More Examples</a><ul>
<li class="chapter" data-level="9.1" data-path="more-examples.html"><a href="more-examples.html#add-more-information-for-gene-expression-matrix"><i class="fa fa-check"></i><b>9.1</b> Add more information for gene expression matrix</a></li>
<li class="chapter" data-level="9.2" data-path="more-examples.html"><a href="more-examples.html#the-measles-vaccine-heatmap"><i class="fa fa-check"></i><b>9.2</b> The measles vaccine heatmap</a></li>
<li class="chapter" data-level="9.3" data-path="more-examples.html"><a href="more-examples.html#visualize-cell-heterogeneity-from-single-cell-rnaseq"><i class="fa fa-check"></i><b>9.3</b> Visualize Cell Heterogeneity from Single Cell RNASeq</a></li>
<li class="chapter" data-level="9.4" data-path="more-examples.html"><a href="more-examples.html#correlations-between-methylation-expression-and-other-genomic-features"><i class="fa fa-check"></i><b>9.4</b> Correlations between methylation, expression and other genomic features</a></li>
<li class="chapter" data-level="9.5" data-path="more-examples.html"><a href="more-examples.html#visualize-methylation-profile-with-complex-annotations"><i class="fa fa-check"></i><b>9.5</b> Visualize Methylation Profile with Complex Annotations</a></li>
<li class="chapter" data-level="9.6" data-path="more-examples.html"><a href="more-examples.html#add-multiple-boxplots-for-single-row"><i class="fa fa-check"></i><b>9.6</b> Add multiple boxplots for single row</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="other-high-level-plots.html"><a href="other-high-level-plots.html"><i class="fa fa-check"></i><b>10</b> Other High-level Plots</a><ul>
<li class="chapter" data-level="10.1" data-path="other-high-level-plots.html"><a href="other-high-level-plots.html#density-heatmap"><i class="fa fa-check"></i><b>10.1</b> Density heatmap</a></li>
<li class="chapter" data-level="10.2" data-path="other-high-level-plots.html"><a href="other-high-level-plots.html#stacked-summary-plot"><i class="fa fa-check"></i><b>10.2</b> Stacked summary plot</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="other-tricks.html"><a href="other-tricks.html"><i class="fa fa-check"></i><b>11</b> Other Tricks</a><ul>
<li class="chapter" data-level="11.1" data-path="other-tricks.html"><a href="other-tricks.html#set-the-same-cell-size-for-different-heatmaps-with-different-dimensions"><i class="fa fa-check"></i><b>11.1</b> Set the same cell size for different heatmaps with different dimensions</a></li>
<li class="chapter" data-level="11.2" data-path="other-tricks.html"><a href="other-tricks.html#integrate-with-gridtext-package"><i class="fa fa-check"></i><b>11.2</b> Integrate with gridtext package</a><ul>
<li class="chapter" data-level="11.2.1" data-path="other-tricks.html"><a href="other-tricks.html#titles"><i class="fa fa-check"></i><b>11.2.1</b> Titles</a></li>
<li class="chapter" data-level="11.2.2" data-path="other-tricks.html"><a href="other-tricks.html#rowcolumn-names"><i class="fa fa-check"></i><b>11.2.2</b> Row/column names</a></li>
<li class="chapter" data-level="11.2.3" data-path="other-tricks.html"><a href="other-tricks.html#annotation-labels-1"><i class="fa fa-check"></i><b>11.2.3</b> Annotation labels</a></li>
<li class="chapter" data-level="11.2.4" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#text-annotation"><i class="fa fa-check"></i><b>11.2.4</b> Text annotation</a></li>
<li class="chapter" data-level="11.2.5" data-path="other-tricks.html"><a href="other-tricks.html#legend"><i class="fa fa-check"></i><b>11.2.5</b> Legend</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ComplexHeatmap Complete Reference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="legends" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Legends</h1>
<p>The heatmaps and simple annotations automatically generate legends which are put one the right side of the heatmap. By default there is no legend for complex annotations, but they can be constructed and added manually (Section <a href="legends.html#add-customized-legends">5.5</a>). All legends are internally constructed by <code>Legend()</code> constructor. In later sections, we first introduce the settings for continuous legends and discrete legends, then we will discuss how to configure the legends associated with the heatmaps and annotations, and how to add new legends to the plot.</p>
<p>All the legends (no matter a single legend or a pack of legends) all belong to the <code>Legends</code> class. The class only has one slot <code>grob</code> which is the real <code>grid::grob</code> object or the <code>grid::gTree</code> object that records how to draw the graphics. The wrapping of the <code>Legends</code> class and the methods designed for the class make legends as single objects and can be drawn like points with specifying the positions on the viewport.</p>
<p>The legends for heatmaps and annotations can be controlled by <code>heatmap_legend_param</code> argument in <code>Heatmap()</code>, or <code>annotation_legend_param</code> argument in <code>HeatmapAnnotation()</code>. <strong>Most of the parameters in <code>Legend()</code> function can be directly set in the two arguments with the same parameter name.</strong> The details of setting heatmap legends and annotation legends parameters are introduced in Section <a href="legends.html#heatmap-and-annotation-legends">5.4</a>.</p>
<div id="continuous-legends" class="section level2">
<h2><span class="header-section-number">5.1</span> Continuous legends</h2>
<p>Since most of heatmaps contain continuous values, we first introduce the settings for the continuous legend.</p>
<p>Continuous legend needs a color mapping function which should be generated by <code>circlize::colorRamp2()</code>. In the heatmap legends and annotation legends that are automatically generated, the color mapping functions are passed by the <code>col</code> argument from <code>Heatmap()</code> or <code>HeatmapAnnotation()</code> function, while if you construct a self-defined legend, you need to provide the color mapping function.</p>
<p>The break values provided in the color mapping function (e.g. <code>c(0, 0.5, 1)</code> in following example) will not exactly be the same as the break values in the legends). The finally break values presented in the legend are internally adjusted to make the numbers of labels close to 5 or 6.</p>
<p>First we show the default style of a vertical continuous legend:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(circlize)
col_fun =<span class="st"> </span><span class="kw">colorRamp2</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;red&quot;</span>))
lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-3-1.png" width="52.5490813648294" style="display: block; margin: auto;" /></p>
<p><code>lgd</code> is a <code>Legends</code> class object. The size of the legend can be obtained by <code>ComplexHeatmap:::width()</code> and <code>ComplexHeatmap:::height()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ComplexHeatmap<span class="op">:::</span><span class="kw">width</span>(lgd)</code></pre></div>
<pre><code>## [1] 9.90361111111111mm</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ComplexHeatmap<span class="op">:::</span><span class="kw">height</span>(lgd)</code></pre></div>
<pre><code>## [1] 28.0329444444444mm</code></pre>
<p>The legend is actually a packed graphic object composed of rectangles, lines and texts. It can be added to the plot by <code>draw()</code> function. In <strong>ComplexHeatmap</strong> pacakge, you don’t need to use <code>draw()</code> directly on legend objects, but it might be useful if you use the legend objects in other places.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pushViewport</span>(<span class="kw">viewport</span>(<span class="dt">width =</span> <span class="fl">0.9</span>, <span class="dt">height =</span> <span class="fl">0.9</span>))
<span class="kw">grid.rect</span>()  <span class="co"># border</span>
<span class="kw">draw</span>(lgd, <span class="dt">x =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>), <span class="dt">y =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>), <span class="dt">just =</span> <span class="kw">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>))
<span class="kw">draw</span>(lgd, <span class="dt">x =</span> <span class="kw">unit</span>(<span class="fl">0.5</span>, <span class="st">&quot;npc&quot;</span>), <span class="dt">y =</span> <span class="kw">unit</span>(<span class="fl">0.5</span>, <span class="st">&quot;npc&quot;</span>))
<span class="kw">draw</span>(lgd, <span class="dt">x =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>), <span class="dt">y =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>), <span class="dt">just =</span> <span class="kw">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>))
<span class="kw">popViewport</span>()</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>If you only want to configure the legends generated by heatmaps or annotations, you don’t need to construct the <code>Legends</code> object by your own. <strong>The parameters introduced later can be directly used to customize the legends by <code>heatmap_legend_param</code> argument in <code>Heatmap()</code> and <code>annotation_legend_param</code> argument in <code>HeatmapAnnotation()</code></strong> (introduced in Section <a href="legends.html#heatmap-and-annotation-legends">5.4</a>). It is still nice to see how these parameters change the styles of the legend in following examples. Following is a simple example showing how to configure legends in the heatmap and heatmap annotation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Heatmap</span>(<span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>), <span class="dv">10</span>), 
    <span class="dt">heatmap_legend_param =</span> <span class="kw">list</span>(
        <span class="dt">title =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">2</span>), 
        <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;neg_two&quot;</span>, <span class="st">&quot;zero&quot;</span>, <span class="st">&quot;pos_two&quot;</span>)
    ),
    <span class="dt">top_annotation =</span> <span class="kw">HeatmapAnnotation</span>(
        <span class="dt">foo =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,
        <span class="dt">annotation_legend_param =</span> <span class="kw">list</span>(<span class="dt">foo =</span> <span class="kw">list</span>(<span class="dt">title =</span> <span class="st">&quot;foo_top_anno&quot;</span>))
    ))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>In following examples, we only show how to construct the legend object, while not show the code which draws the legends. Only remember you can use <code>draw()</code> function on the <code>Legends</code> object to draw the single legend on the plot.</p>
<p>For continuous legend, you can manually adjust the break values in the legend by setting <code>at</code>. Note the height is automatically adjusted.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="dv">1</span>))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-8-1.png" width="59.9624146981627" style="display: block; margin: auto;" /></p>
<p>The labels corresponding to the break values are set by <code>labels</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), 
    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;median&quot;</span>, <span class="st">&quot;high&quot;</span>))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-10-1.png" width="77.7357480314961" style="display: block; margin: auto;" /></p>
<p>The height of the vertical continous legend is set by <code>legend_height</code>. <code>legend_height</code> can only be set for the veritcal continous legend and the value is the height of the legend body (excluding the legend title).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">legend_height =</span> <span class="kw">unit</span>(<span class="dv">6</span>, <span class="st">&quot;cm&quot;</span>))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-12-1.png" width="52.5490813648294" style="display: block; margin: auto;" /></p>
<p>If it is a vertical legend, <code>grid_width</code> controls the widths of the legend body. <code>grid_width</code> is originally designed for the discrete legends where the each level in the legend is a grid, but here we use the same name for the parameter that controls the width of the legend.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">grid_width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-14-1.png" width="75.2262467191601" style="display: block; margin: auto;" /></p>
<p>The graphic parameters for the labels are controlled by <code>labels_gp</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">labels_gp =</span> <span class="kw">gpar</span>(<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">font =</span> <span class="dv">3</span>))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-16-1.png" width="52.5490813648294" style="display: block; margin: auto;" /></p>
<p>The border of the legend as well as the ticks for the break values are controlled by <code>border</code>. The value of <code>border</code> can be logical or a string of color.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-18-1.png" width="52.5490813648294" style="display: block; margin: auto;" /></p>
<p><code>title_position</code> controls the position of titles. For vertical legends, the value should be one of <code>topleft</code>, <code>topcenter</code>, <code>lefttop-rot</code> and <code>leftcenter-rot</code>. Following two plots show the effect of <code>lefttop-rot</code> title and <code>leftcenter-rot</code> title.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;foooooooo&quot;</span>, <span class="dt">title_position =</span> <span class="st">&quot;lefttop-rot&quot;</span>,
    <span class="dt">legend_height =</span> <span class="kw">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-20-1.png" width="67.7917060367454" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;foooooooo&quot;</span>, <span class="dt">title_position =</span> <span class="st">&quot;leftcenter-rot&quot;</span>,
    <span class="dt">legend_height =</span> <span class="kw">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-22-1.png" width="67.7917060367454" style="display: block; margin: auto;" /></p>
<p>Legend titles and labels can be set as mathematical formulas.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="kw">expression</span>(<span class="kw">hat</span>(beta) <span class="op">==</span><span class="st"> </span>(X<span class="op">^</span>t <span class="op">*</span><span class="st"> </span>X)<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>} <span class="op">*</span><span class="st"> </span>X<span class="op">^</span>t <span class="op">*</span><span class="st"> </span>y), 
    <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="dv">1</span>), <span class="dt">labels =</span> <span class="kw">expression</span>(alpha, beta, gamma, delta, epsilon))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-24-1.png" width="96.3218139399242" style="display: block; margin: auto;" /></p>
<p>Settings for horizontal continuous legends are almost the same as vertical legends, except that now <code>legend_width</code> controls the width of the legend, and the title position can only be one of <code>topcenter</code>, <code>topleft</code>, <code>lefttop</code> and <code>leftcenter</code>.</p>
<p>The default style for horizontal legend:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-26-1.png" width="148.55811023622" style="display: block; margin: auto;" /></p>
<p>Manually set <code>at</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="dv">1</span>), 
    <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-28-1.png" width="142.99811023622" style="display: block; margin: auto;" /></p>
<p>Manually set <code>labels</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), 
    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;median&quot;</span>, <span class="st">&quot;high&quot;</span>), <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-30-1.png" width="148.19811023622" style="display: block; margin: auto;" /></p>
<p>Set <code>legend_width</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">legend_width =</span> <span class="kw">unit</span>(<span class="dv">6</span>, <span class="st">&quot;cm&quot;</span>), 
    <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-32-1.png" width="241.889763779528" style="display: block; margin: auto;" /></p>
<p>Set graphic parameters for labels:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">labels_gp =</span> <span class="kw">gpar</span>(<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">font =</span> <span class="dv">3</span>), 
    <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-34-1.png" width="148.55811023622" style="display: block; margin: auto;" /></p>
<p>Set rotations of labels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">labels_rot =</span> <span class="dv">45</span>, 
    <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-36-1.png" width="170.398759384786" style="display: block; margin: auto;" /></p>
<p>Title can be set as <code>topleft</code>, <code>topcenter</code> or <code>lefttop</code> and <code>leftcenter</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;foooooooo&quot;</span>, <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>, 
    <span class="dt">title_position =</span> <span class="st">&quot;topcenter&quot;</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-38-1.png" width="148.55811023622" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;foooooooo&quot;</span>, <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>, 
    <span class="dt">title_position =</span> <span class="st">&quot;lefttop&quot;</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-40-1.png" width="223.57406824147" style="display: block; margin: auto;" /></p>
<p>In examples we showed above, the intervals between every two break values are equal. Actually <code>at</code> can also be set as break values with uneuqal intervals. In this scenario, the ticks on the legend are still at the original places while the corresponding texts are shifted to get rid of overlapping. Then, there are lines connecting the ticks and the labels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="dv">1</span>))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-42-1.png" width="71.3009973753281" style="display: block; margin: auto;" /></p>
<p>If the labels do not need to be adjusted, they are still at the original places.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>, <span class="dv">1</span>), 
    <span class="dt">legend_height =</span> <span class="kw">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-44-1.png" width="52.5490813648294" style="display: block; margin: auto;" /></p>
<p>It is similar for the horizontal legends:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="dv">1</span>),
    <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-46-1.png" width="198.59811023622" style="display: block; margin: auto;" /></p>
<p>Set rotations of labels to 90 degree.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="dv">1</span>),
    <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>, <span class="dt">title_position =</span> <span class="st">&quot;lefttop&quot;</span>, <span class="dt">labels_rot =</span> <span class="dv">90</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-48-1.png" width="141.77406824147" style="display: block; margin: auto;" /></p>
<p>When the position of title is set to <code>lefttop</code>, the area below the title will also be taken into account when calculating the adjusted positions of labels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="dv">1</span>),
    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;mininal&quot;</span>, <span class="st">&quot;q10&quot;</span>, <span class="st">&quot;median&quot;</span>, <span class="st">&quot;q75&quot;</span>, <span class="st">&quot;maximal&quot;</span>),
    <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>, <span class="dt">title_position =</span> <span class="st">&quot;lefttop&quot;</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-50-1.png" width="311.33406824147" style="display: block; margin: auto;" /></p>
</div>
<div id="discrete-legends" class="section level2">
<h2><span class="header-section-number">5.2</span> Discrete legends</h2>
<p>Discrete legends are used for discrete color mappings. The continuous color mapping can also be degenerated as discrete color mapping by only providing the colors and the break values.</p>
<p>You can either specify <code>at</code> or <code>labels</code>, but most probably you specify <code>labels</code>. The colors should be specified by <code>legend_gp</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">at =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-52-1.png" width="41.4290813648294" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">labels =</span> month.name[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-54-1.png" width="87.5624146981627" style="display: block; margin: auto;" /></p>
<p>The discrete legend for continuous color mapping:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">at =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.2</span>)
lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">at =</span> at, <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="kw">col_fun</span>(at)))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-56-1.png" width="52.5490813648294" style="display: block; margin: auto;" /></p>
<p>The position of title:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">labels =</span> month.name[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>),
    <span class="dt">title_position =</span> <span class="st">&quot;lefttop&quot;</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-58-1.png" width="113.698372703412" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">labels =</span> month.name[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>),
    <span class="dt">title_position =</span> <span class="st">&quot;leftcenter-rot&quot;</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-60-1.png" width="102.805039370079" style="display: block; margin: auto;" /></p>
<p>The size of grids are controlled by <code>grid_width</code> and <code>grid_height</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">at =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, 
    <span class="dt">grid_height =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>), <span class="dt">grid_width =</span> <span class="kw">unit</span>(<span class="dv">5</span>, <span class="st">&quot;mm&quot;</span>))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-62-1.png" width="45.2086089238845" style="display: block; margin: auto;" /></p>
<p>The graphic parameters of labels are controlled by <code>labels_gp</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">labels =</span> month.name[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, 
    <span class="dt">labels_gp =</span> <span class="kw">gpar</span>(<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">fontsize =</span> <span class="dv">14</span>))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-64-1.png" width="108.981081364829" style="display: block; margin: auto;" /></p>
<p>The graphic parameters of the title are controlled by <code>title_gp</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">labels =</span> month.name[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, 
    <span class="dt">title_gp =</span> <span class="kw">gpar</span>(<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">fontsize =</span> <span class="dv">14</span>))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-66-1.png" width="87.5624146981627" style="display: block; margin: auto;" /></p>
<p>Borders of grids are controlled by <code>border</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">labels =</span> month.name[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, 
    <span class="dt">border =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-68-1.png" width="87.5624146981627" style="display: block; margin: auto;" /></p>
<p>One important thing for the discrete legend is you can arrange the grids into multiple rows or/and columns. If <code>ncol</code> is set to a number, the grids are arranged into <code>ncol</code> columns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">labels =</span> month.name[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>], <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>), 
    <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-70-1.png" width="246.795800524934" style="display: block; margin: auto;" /></p>
<p>Still the title position is calculated based on the multiplt-column legend.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">labels =</span> month.name[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>], <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>), <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, 
    <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">title_position =</span> <span class="st">&quot;topcenter&quot;</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-72-1.png" width="246.795800524934" style="display: block; margin: auto;" /></p>
<p>You can choose to list the legend levels by rows by setting <code>by_row = TRUE</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">labels =</span> month.name[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>], <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>), <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, 
    <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">by_row =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-74-1.png" width="253.115800524934" style="display: block; margin: auto;" /></p>
<p>The gap between two columns are controlled by <code>gap</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">labels =</span> month.name[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>], <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>), <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, 
    <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">gap =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-76-1.png" width="307.268241469816" style="display: block; margin: auto;" /></p>
<p>Instead of <code>ncol</code>, you can also specify the layout by <code>nrow</code>. Note you cannot use <code>ncol</code> and <code>nrow</code> at a same time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">labels =</span> month.name[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>], <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>), 
    <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">nrow =</span> <span class="dv">3</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-78-1.png" width="308.21249343832" style="display: block; margin: auto;" /></p>
<p>One extreme case is when all levels are put in one row and the title are rotated by 90 degree. The height of the legend will be the height of the rotated title.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">labels =</span> month.name[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">title =</span> <span class="st">&quot;foooooo&quot;</span>, 
    <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">title_position =</span> <span class="st">&quot;lefttop-rot&quot;</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-80-1.png" width="399.848503937008" style="display: block; margin: auto;" /></p>
<p>Following style a lot of people might like:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">labels =</span> month.name[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">title =</span> <span class="st">&quot;foooooo&quot;</span>, 
    <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">title_position =</span> <span class="st">&quot;leftcenter&quot;</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-82-1.png" width="443.328503937008" style="display: block; margin: auto;" /></p>
<p><code>Legend()</code> also supports to use simple graphics (e.g. points, lines, boxplots) as legends. <code>type</code> argument can be specified as <code>points</code> or <code>p</code> that you can use number for <code>pch</code> or single-letter for <code>pch</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">labels =</span> month.name[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;points&quot;</span>, 
    <span class="dt">pch =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">background =</span> <span class="st">&quot;#FF8080&quot;</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-84-1.png" width="87.5624146981627" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">labels =</span> month.name[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;points&quot;</span>, 
    <span class="dt">pch =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">background =</span> <span class="st">&quot;white&quot;</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-86-1.png" width="87.5624146981627" style="display: block; margin: auto;" /></p>
<p>Or set <code>type = &quot;lines&quot;</code>/<code>type = &quot;l&quot;</code> to use lines as legend:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">labels =</span> month.name[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;lines&quot;</span>, 
    <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">grid_width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-88-1.png" width="110.239580052493" style="display: block; margin: auto;" /></p>
<p>Or set <code>type = &quot;boxplot&quot;</code>/<code>type = &quot;box&quot;</code> to use boxes as legends:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">labels =</span> month.name[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], <span class="dt">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;boxplot&quot;</span>,
    <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-90-1.png" width="87.5624146981627" style="display: block; margin: auto;" /></p>
<p>When <code>pch</code> is an integer number, the numbers in <code>26:28</code> correspond to following symbols:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">labels =</span> <span class="kw">paste0</span>(<span class="st">&quot;pch = &quot;</span>, <span class="dv">26</span><span class="op">:</span><span class="dv">28</span>), <span class="dt">type =</span> <span class="st">&quot;points&quot;</span>, <span class="dt">pch =</span> <span class="dv">26</span><span class="op">:</span><span class="dv">28</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-92-1.png" width="85.5357480314961" style="display: block; margin: auto;" /></p>
<p>If you want more legend styles to be supported, contact me.</p>
</div>
<div id="a-list-of-legends" class="section level2">
<h2><span class="header-section-number">5.3</span> A list of legends</h2>
<p>A list of legends can be constructed or packed as a <code>Legends</code> object where the individual legends are arranged within a certain layout. The legend list can be sent to <code>packLegend()</code> separatedly or as a list. The legend can be arranged either vertically or horizontally. <strong>ComplexHeatmap</strong> uses <code>packLegend()</code> internally to arrange multiple legends. Normally you don’t need to manually control the arrangement of multiple legends, but the following section would be useful if you want to manually construct a list of legends and apply to other plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd1 =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">at =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">title =</span> <span class="st">&quot;legend1&quot;</span>)
lgd2 =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;legend2&quot;</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="dv">1</span>))
lgd3 =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">labels =</span> month.name[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="dv">7</span><span class="op">:</span><span class="dv">9</span>), <span class="dt">title =</span> <span class="st">&quot;legend3&quot;</span>)

pd =<span class="st"> </span><span class="kw">packLegend</span>(lgd1, lgd2, lgd3)
<span class="co"># which is same as </span>
pd =<span class="st"> </span><span class="kw">packLegend</span>(<span class="dt">list =</span> <span class="kw">list</span>(lgd1, lgd2, lgd3))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-94-1.png" width="87.5624146981627" style="display: block; margin: auto;" /></p>
<p>Simillar as single legend, you can draw the packed legends by <code>draw()</code> function. Also you can get the size of <code>pd</code> by <code>ComplexHeatmap:::width()</code> and <code>ComplexHeatmap:::height()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ComplexHeatmap<span class="op">:::</span><span class="kw">width</span>(pd)</code></pre></div>
<pre><code>## [1] 19.1675555555556mm</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ComplexHeatmap<span class="op">:::</span><span class="kw">height</span>(pd)</code></pre></div>
<pre><code>## [1] 72.0988333333333mm</code></pre>
<p>Horizontally arranging the legends simply by setting <code>direction = &quot;horizontal&quot;</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pd =<span class="st"> </span><span class="kw">packLegend</span>(lgd1, lgd2, lgd3, <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-97-1.png" width="203.720524934383" style="display: block; margin: auto;" /></p>
<p>One feature of <code>packLegend()</code> is, e.g. if the packing is vertically and the sum of the packed legends exceeds the height specified by <code>max_height</code>, it will be rearragned as mutliple column layout. In following example, the maximum height is <code>10cm</code>.</p>
<p>When all the legends are put into multiple columns, <code>column_gap</code> controls the space between two columns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pd =<span class="st"> </span><span class="kw">packLegend</span>(lgd1, lgd3, lgd2, lgd3, lgd2, lgd1, <span class="dt">max_height =</span> <span class="kw">unit</span>(<span class="dv">10</span>, <span class="st">&quot;cm&quot;</span>), 
    <span class="dt">column_gap =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-99-1.png" width="197.801994750656" style="display: block; margin: auto;" /></p>
<p>Similar for horizontal packing:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd1 =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">at =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">title =</span> <span class="st">&quot;legend1&quot;</span>,
    <span class="dt">nr =</span> <span class="dv">1</span>)
lgd2 =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">col_fun =</span> col_fun, <span class="dt">title =</span> <span class="st">&quot;legend2&quot;</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="dv">1</span>),
    <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>)

pd =<span class="st"> </span><span class="kw">packLegend</span>(lgd1, lgd2, lgd3, lgd1, lgd2, lgd3, <span class="dt">max_width =</span> <span class="kw">unit</span>(<span class="dv">10</span>, <span class="st">&quot;cm&quot;</span>), 
    <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>, <span class="dt">column_gap =</span> <span class="kw">unit</span>(<span class="dv">5</span>, <span class="st">&quot;mm&quot;</span>), <span class="dt">row_gap =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-101-1.png" width="357.556850393701" style="display: block; margin: auto;" /></p>
<p>The packed legends <code>pd</code> is also a <code>Legends</code> object, which means you can use <code>draw()</code> to draw it by specifying the positions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pd =<span class="st"> </span><span class="kw">packLegend</span>(lgd1, lgd2, lgd3, <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>)
<span class="kw">pushViewport</span>(<span class="kw">viewport</span>(<span class="dt">width =</span> <span class="fl">0.8</span>, <span class="dt">height =</span> <span class="fl">0.8</span>))
<span class="kw">grid.rect</span>()
<span class="kw">draw</span>(pd, <span class="dt">x =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>), <span class="dt">y =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>), <span class="dt">just =</span> <span class="kw">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>))
<span class="kw">popViewport</span>()</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-102-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>To be mentioned again, <code>packLegend()</code> is used internally to manage the list of heatmap and annotation legends.</p>
</div>
<div id="heatmap-and-annotation-legends" class="section level2">
<h2><span class="header-section-number">5.4</span> Heatmap and annotation legends</h2>
<p>Settings for heatmap legend are controlled by <code>heatmap_legend_param</code> argument in <code>Heatmap()</code>. The value for <code>heatmap_legend_param</code> is a list of parameters which are supported in <code>Legend()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>), <span class="dv">10</span>)
<span class="kw">Heatmap</span>(m, <span class="dt">name =</span> <span class="st">&quot;mat&quot;</span>, <span class="dt">heatmap_legend_param =</span> <span class="kw">list</span>(
    <span class="dt">at =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">2</span>),
    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;zero&quot;</span>, <span class="st">&quot;high&quot;</span>),
    <span class="dt">title =</span> <span class="st">&quot;Some values&quot;</span>,
    <span class="dt">legend_height =</span> <span class="kw">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>),
    <span class="dt">title_position =</span> <span class="st">&quot;lefttop-rot&quot;</span>
))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-103-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><code>annotation_legend_param</code> controls legends for annotations. Since a <code>HeatmapAnnotation</code> may contain multiple annotations, the value of <code>annotation_legend_param</code> is a list of configurations of each annotation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ha =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">foo =</span> <span class="kw">runif</span>(<span class="dv">10</span>), <span class="dt">bar =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>), <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>),
    <span class="dt">annotation_legend_param =</span> <span class="kw">list</span>(
        <span class="dt">foo =</span> <span class="kw">list</span>(
                <span class="dt">title =</span> <span class="st">&quot;Fooooooh&quot;</span>,
                <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>),
                <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;zero&quot;</span>, <span class="st">&quot;median&quot;</span>, <span class="st">&quot;one&quot;</span>)
            ),
        <span class="dt">bar =</span> <span class="kw">list</span>(
                <span class="dt">title =</span> <span class="st">&quot;Baaaaaaar&quot;</span>,
                <span class="dt">at =</span> <span class="kw">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>),
                <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Male&quot;</span>)
            )
))
<span class="kw">Heatmap</span>(m, <span class="dt">name =</span> <span class="st">&quot;mat&quot;</span>, <span class="dt">top_annotation =</span> ha)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-104-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>If the heatmaps are concatenated horizontally, all heatmap and row annotation legends are grouped and all column annotation legends ae grouped. The reason we assume the horizontal direction passes the main message of the plot, while the vertical direction provides secondary information.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ha1 =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">foo1 =</span> <span class="kw">runif</span>(<span class="dv">10</span>), <span class="dt">bar1 =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>), <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>))
ha2 =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">foo2 =</span> <span class="kw">runif</span>(<span class="dv">10</span>), <span class="dt">bar2 =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>), <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>))
<span class="kw">Heatmap</span>(m, <span class="dt">name =</span> <span class="st">&quot;mat1&quot;</span>, <span class="dt">top_annotation =</span> ha1) <span class="op">+</span>
<span class="kw">rowAnnotation</span>(<span class="dt">sth =</span> <span class="kw">runif</span>(<span class="dv">10</span>)) <span class="op">+</span>
<span class="kw">Heatmap</span>(m, <span class="dt">name =</span> <span class="st">&quot;mat2&quot;</span>, <span class="dt">top_annotation =</span> ha2)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-105-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Similarlly, if the heatmaps are concatenated vertically, all heatmaps/column annotations are grouped and legends for all row annotations are grouped.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ha1 =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">foo1 =</span> <span class="kw">runif</span>(<span class="dv">10</span>), <span class="dt">bar1 =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>), <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>), 
    <span class="dt">annotation_name_side =</span> <span class="st">&quot;left&quot;</span>)
ha2 =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">foo2 =</span> <span class="kw">runif</span>(<span class="dv">10</span>), <span class="dt">bar2 =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>), <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>))
<span class="kw">Heatmap</span>(m, <span class="dt">name =</span> <span class="st">&quot;mat1&quot;</span>, <span class="dt">top_annotation =</span> ha1) <span class="op">%v%</span>
<span class="kw">Heatmap</span>(m, <span class="dt">name =</span> <span class="st">&quot;mat2&quot;</span>, <span class="dt">top_annotation =</span> ha2, 
    <span class="dt">right_annotation =</span> <span class="kw">rowAnnotation</span>(<span class="dt">sth =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-106-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><code>show_legend</code> in <code>HeatmapAnnotation()</code> and <code>show_heatmap_legend</code> in <code>Heatmap()</code> controls whether show the legends. Note <code>show_legend</code> can be a single logical value, a logical vector, or a named vector which controls subset of annotations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ha =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">foo =</span> <span class="kw">runif</span>(<span class="dv">10</span>), 
    <span class="dt">bar =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>), <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>),
    <span class="dt">show_legend =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>), <span class="co"># it can also be show_legend = c(bar = FALSE)</span>
    <span class="dt">annotation_name_side =</span> <span class="st">&quot;left&quot;</span>)
<span class="kw">Heatmap</span>(m, <span class="dt">name =</span> <span class="st">&quot;mat1&quot;</span>, <span class="dt">top_annotation =</span> ha) <span class="op">+</span>
<span class="kw">Heatmap</span>(m, <span class="dt">name =</span> <span class="st">&quot;mat2&quot;</span>, <span class="dt">show_heatmap_legend =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-107-1.png" width="768" style="display: block; margin: auto;" /></p>
<p><code>merge_legend</code> in <code>draw()</code> function controlls whether to merge all the legends into a single group. Normally, when there are many annotations and heatmaps, the number of legends is always large. In this case, the legends are automatically arranged into multiple columns (or multiple rows if they are put at the bottom of the heatmaps) to get rid of being out of the figure page. If a heatmap has heatmap annotations, the order of putting legends are: legends for the left annotations, legends for the top annotations, legend of the heatmap, legends for the bottom annotations and legends for the right annotations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ha1 =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">foo1 =</span> <span class="kw">runif</span>(<span class="dv">10</span>), 
    <span class="dt">bar1 =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>), <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>))
ha2 =<span class="st"> </span><span class="kw">rowAnnotation</span>(<span class="dt">foo2 =</span> <span class="kw">runif</span>(<span class="dv">10</span>), 
    <span class="dt">bar2 =</span> <span class="kw">sample</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>))
ha3 =<span class="st"> </span><span class="kw">rowAnnotation</span>(<span class="dt">foo3 =</span> <span class="kw">runif</span>(<span class="dv">10</span>), 
    <span class="dt">bar3 =</span> <span class="kw">sample</span>(month.name[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>))
ht_list =<span class="st"> </span><span class="kw">Heatmap</span>(m, <span class="dt">name =</span> <span class="st">&quot;mat1&quot;</span>, <span class="dt">top_annotation =</span> ha1) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">Heatmap</span>(m, <span class="dt">name =</span> <span class="st">&quot;mat2&quot;</span>, <span class="dt">left_annotation =</span> ha2) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span>ha3
<span class="kw">draw</span>(ht_list, <span class="dt">merge_legend =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-108-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>A continuous color mapping can have a discrete legend by setting <code>color_bar = &quot;discrete&quot;)</code>, both work for heatmap legends and annotation legends.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Heatmap</span>(m, <span class="dt">name =</span> <span class="st">&quot;mat&quot;</span>, <span class="dt">heatmap_legend_param =</span> <span class="kw">list</span>(<span class="dt">color_bar =</span> <span class="st">&quot;discrete&quot;</span>),
    <span class="dt">top_annotation =</span> <span class="kw">HeatmapAnnotation</span>(<span class="dt">foo =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,
        <span class="dt">annotation_legend_param =</span> <span class="kw">list</span>(
            <span class="dt">foo =</span> <span class="kw">list</span>(<span class="dt">color_bar =</span> <span class="st">&quot;discrete&quot;</span>))))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-109-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>If the <code>value</code> is a character vector, no matter it is an annotation or the one-row/one-column matrix for the heatmap, the default order of legend labels is <code>sort(unique(value))</code> and if <code>value</code> is a factor, the order of legend labels is <code>levels(value)</code>. Always remember the order can be fine-tuned by setting <code>at</code> and <code>labels</code> parameters in <code>heatmap_legend_param</code>/<code>annotation_legend_param</code> in <code>Heatmap()</code>/<code>HeamtapAnnotation()</code> functions respectively.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">chr =<span class="st"> </span><span class="kw">sample</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
chr</code></pre></div>
<pre><code>##  [1] &quot;a&quot; &quot;c&quot; &quot;c&quot; &quot;b&quot; &quot;c&quot; &quot;a&quot; &quot;b&quot; &quot;a&quot; &quot;b&quot; &quot;a&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fa1 =<span class="st"> </span><span class="kw">factor</span>(chr)
fa2 =<span class="st"> </span><span class="kw">factor</span>(chr, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>))
<span class="kw">Heatmap</span>(m, <span class="dt">top_annotation =</span> <span class="kw">HeatmapAnnotation</span>(<span class="dt">chr =</span> chr, <span class="dt">fa1 =</span> fa1, <span class="dt">fa2 =</span> fa2, <span class="dt">fa3 =</span> fa2,
    <span class="dt">annotation_legend_param =</span> <span class="kw">list</span>(<span class="dt">fa3 =</span> <span class="kw">list</span>(<span class="dt">at =</span> <span class="kw">c</span>(<span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;a&quot;</span>)))))</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-110-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="add-customized-legends" class="section level2">
<h2><span class="header-section-number">5.5</span> Add customized legends</h2>
<p>The self-defined legends (constructed by <code>Legend()</code>) can be added to the heatmap legend list by <code>heatmap_legend_list</code> argument in <code>draw()</code> and the legends for annotations can be added to the annotation legend list by <code>annotation_legend_list</code> argument.</p>
<p>There is a nice example of adding self-defined legends in Section <a href="other-high-level-plots.html#stacked-summary-plot">10.2</a>, but here we show a simple example.</p>
<p>As mentioned before, only the heatmap and simple annotations can generate legends on the plot. <strong>ComplexHeatmap</strong> provides many annotation functions, but none of them supports generating legends. In following code, we add a point annotation, a line annotation and a summary annotation to the heatmaps.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ha1 =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">pt =</span> <span class="kw">anno_points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">gp =</span> <span class="kw">gpar</span>(<span class="dt">col =</span> <span class="kw">rep</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">each =</span> <span class="dv">5</span>)), 
    <span class="dt">height =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>)), <span class="dt">show_annotation_name =</span> <span class="ot">FALSE</span>)
ha2 =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">ln =</span> <span class="kw">anno_lines</span>(<span class="kw">cbind</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">10</span><span class="op">:</span><span class="dv">1</span>), <span class="dt">gp =</span> <span class="kw">gpar</span>(<span class="dt">col =</span> <span class="dv">4</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>),
    <span class="dt">height =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>)), <span class="dt">show_annotation_name =</span> <span class="ot">FALSE</span>)
m =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>), <span class="dv">10</span>)
ht_list =<span class="st"> </span><span class="kw">Heatmap</span>(m, <span class="dt">name =</span> <span class="st">&quot;mat1&quot;</span>, <span class="dt">top_annotation =</span> ha1) <span class="op">+</span><span class="st"> </span>
<span class="st">          </span><span class="kw">Heatmap</span>(m, <span class="dt">name =</span> <span class="st">&quot;mat2&quot;</span>, <span class="dt">top_annotation =</span> ha2) <span class="op">+</span>
<span class="st">          </span><span class="kw">Heatmap</span>(m[, <span class="dv">1</span>], <span class="dt">name =</span> <span class="st">&quot;mat3&quot;</span>, 
            <span class="dt">top_annotation =</span> <span class="kw">HeatmapAnnotation</span>(
                <span class="dt">summary =</span> <span class="kw">anno_summary</span>(<span class="dt">gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>))
          ), <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>))
<span class="kw">draw</span>(ht_list, <span class="dt">ht_gap =</span> <span class="kw">unit</span>(<span class="dv">7</span>, <span class="st">&quot;mm&quot;</span>), <span class="dt">row_km =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-111-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Next we construct legends for the points, the lines and the boxplots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd_list =<span class="st"> </span><span class="kw">list</span>(
    <span class="kw">Legend</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>), <span class="dt">title =</span> <span class="st">&quot;pt&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;points&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>, 
        <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">col =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>)),
    <span class="kw">Legend</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;lightblue&quot;</span>), <span class="dt">title =</span> <span class="st">&quot;ln&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;lines&quot;</span>, 
        <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">col =</span> <span class="dv">4</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)),
    <span class="kw">Legend</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;group1&quot;</span>, <span class="st">&quot;group2&quot;</span>), <span class="dt">title =</span> <span class="st">&quot;km&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;boxplot&quot;</span>,
        <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>))
)
<span class="kw">draw</span>(ht_list, <span class="dt">ht_gap =</span> <span class="kw">unit</span>(<span class="dv">7</span>, <span class="st">&quot;mm&quot;</span>), <span class="dt">row_km =</span> <span class="dv">2</span>, <span class="dt">annotation_legend_list =</span> lgd_list)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-112-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="the-side-of-legends" class="section level2">
<h2><span class="header-section-number">5.6</span> The side of legends</h2>
<p>By default, the heatmap legends and annotation legends are put on the right of the plot. The side relative to the heatmaps of the two types of legends can be controlled by <code>heatmap_legend_side</code> and <code>annotation_legend_side</code> arguments in <code>draw()</code> function. The values that can be set for the two arguments are <code>left</code>, <code>right</code>, <code>bottom</code> and <code>top</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>), <span class="dv">10</span>)
ha1 =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">foo1 =</span> <span class="kw">runif</span>(<span class="dv">10</span>), <span class="dt">bar1 =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>), <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>))
ha2 =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">foo2 =</span> <span class="kw">runif</span>(<span class="dv">10</span>), <span class="dt">bar2 =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>), <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>))
ht_list =<span class="st"> </span><span class="kw">Heatmap</span>(m, <span class="dt">name =</span> <span class="st">&quot;mat1&quot;</span>, <span class="dt">top_annotation =</span> ha1) <span class="op">+</span>
<span class="st">    </span><span class="kw">rowAnnotation</span>(<span class="dt">sth =</span> <span class="kw">runif</span>(<span class="dv">10</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">Heatmap</span>(m, <span class="dt">name =</span> <span class="st">&quot;mat2&quot;</span>, <span class="dt">top_annotation =</span> ha2)
<span class="kw">draw</span>(ht_list, <span class="dt">heatmap_legend_side =</span> <span class="st">&quot;left&quot;</span>, <span class="dt">annotation_legend_side =</span> <span class="st">&quot;bottom&quot;</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-113-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>When the legends are put at the bottom or on the top, the legends are arranged horizontally. We might also want to set every single legend as horizontal legend, this needs to be set via the <code>heatmap_legend_param</code> and <code>annotation_legend_param</code> arguments in <code>Heatmap()</code> and <code>HeatmapAnnotation()</code> functions:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ha1 =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">foo1 =</span> <span class="kw">runif</span>(<span class="dv">10</span>), <span class="dt">bar1 =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>), <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>),
    <span class="dt">annotation_legend_param =</span> <span class="kw">list</span>(
        <span class="dt">foo1 =</span> <span class="kw">list</span>(<span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>),
        <span class="dt">bar1 =</span> <span class="kw">list</span>(<span class="dt">nrow =</span> <span class="dv">1</span>)))
ha2 =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">foo2 =</span> <span class="kw">runif</span>(<span class="dv">10</span>), <span class="dt">bar2 =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>), <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>),
    <span class="dt">annotation_legend_param =</span> <span class="kw">list</span>(
        <span class="dt">foo2 =</span> <span class="kw">list</span>(<span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>),
        <span class="dt">bar2 =</span> <span class="kw">list</span>(<span class="dt">nrow =</span> <span class="dv">1</span>)))
ht_list =<span class="st"> </span><span class="kw">Heatmap</span>(m, <span class="dt">name =</span> <span class="st">&quot;mat1&quot;</span>, <span class="dt">top_annotation =</span> ha1, 
        <span class="dt">heatmap_legend_param =</span> <span class="kw">list</span>(<span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">rowAnnotation</span>(<span class="dt">sth =</span> <span class="kw">runif</span>(<span class="dv">10</span>), 
        <span class="dt">annotation_legend_param =</span> <span class="kw">list</span>(<span class="dt">sth =</span> <span class="kw">list</span>(<span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>))) <span class="op">+</span>
<span class="st">    </span><span class="kw">Heatmap</span>(m, <span class="dt">name =</span> <span class="st">&quot;mat2&quot;</span>, <span class="dt">top_annotation =</span> ha2,
        <span class="dt">heatmap_legend_param =</span> <span class="kw">list</span>(<span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>))
<span class="kw">draw</span>(ht_list, <span class="dt">merge_legend =</span> <span class="ot">TRUE</span>, <span class="dt">heatmap_legend_side =</span> <span class="st">&quot;bottom&quot;</span>, 
    <span class="dt">annotation_legend_side =</span> <span class="st">&quot;bottom&quot;</span>)</code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-114-1.png" width="768" style="display: block; margin: auto;" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="a-list-of-heatmaps.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="heatmap-decoration.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jokergoo/ComplexHeatmap-reference/edit/master/05-legends.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ComplexHeatmap-reference.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
